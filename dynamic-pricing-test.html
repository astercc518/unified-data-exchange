<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŠ¨æ€å®šä»·ä¸šåŠ¡é€»è¾‘æµ‹è¯•å·¥å…·</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f7fa;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.1);
            padding: 30px;
        }
        
        h1 {
            color: #303133;
            text-align: center;
            margin-bottom: 10px;
            font-size: 28px;
        }
        
        .description {
            text-align: center;
            color: #606266;
            margin-bottom: 30px;
            font-size: 16px;
            background: #f0f9ff;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #409eff;
        }
        
        .section {
            margin-bottom: 30px;
            border: 1px solid #ebeef5;
            border-radius: 6px;
            overflow: hidden;
        }
        
        .section h2 {
            background: #f8f9fa;
            margin: 0;
            padding: 15px 20px;
            color: #303133;
            border-bottom: 1px solid #ebeef5;
            font-size: 18px;
        }
        
        .step {
            padding: 20px;
        }
        
        .step-title {
            font-weight: 600;
            color: #409eff;
            margin-bottom: 15px;
            font-size: 16px;
        }
        
        button {
            background: #409eff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 10px;
            margin-bottom: 10px;
            font-size: 14px;
            transition: background 0.3s;
        }
        
        button:hover {
            background: #337ecc;
        }
        
        button.success {
            background: #67c23a;
        }
        
        button.warning {
            background: #e6a23c;
        }
        
        button.danger {
            background: #f56c6c;
        }
        
        .result {
            margin-top: 15px;
            padding: 15px;
            border-radius: 4px;
            border: 1px solid #ddd;
            background: #f9f9f9;
            font-family: 'Monaco', 'Menlo', monospace;
        }
        
        .result.success {
            background: #f0f9ff;
            border-color: #b3d8ff;
            color: #409eff;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            font-size: 14px;
        }
        
        th, td {
            border: 1px solid #ebeef5;
            padding: 8px 12px;
            text-align: left;
        }
        
        th {
            background: #f5f7fa;
            color: #303133;
            font-weight: 600;
        }
        
        .price {
            color: #f56c6c;
            font-weight: bold;
        }
        
        .tag {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 3px;
            font-size: 12px;
            color: white;
        }
        
        .tag.success {
            background: #67c23a;
        }
        
        .tag.warning {
            background: #e6a23c;
        }
        
        .tag.info {
            background: #909399;
        }
        
        .tag.danger {
            background: #f56c6c;
        }
        
        .input-group {
            margin: 10px 0;
        }
        
        .input-group label {
            display: inline-block;
            width: 120px;
            font-weight: 500;
            color: #606266;
        }
        
        .input-group input, .input-group select {
            padding: 8px 12px;
            border: 1px solid #dcdfe6;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .highlight {
            background: #fff9e6;
            padding: 2px 6px;
            border-radius: 3px;
            color: #e6a23c;
            font-weight: bold;
        }
        
        .test-scenario {
            background: #f0f9ff;
            border: 1px solid #b3d8ff;
            border-radius: 4px;
            padding: 15px;
            margin: 10px 0;
        }
        
        .scenario-title {
            font-weight: bold;
            color: #409eff;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸš€ åŠ¨æ€å®šä»·ä¸šåŠ¡é€»è¾‘æµ‹è¯•å·¥å…·</h1>
        <div class="description">
            æœ¬æµ‹è¯•å·¥å…·ç”¨äºéªŒè¯å¤æ‚çš„åŠ¨æ€å®šä»·ä¸šåŠ¡é€»è¾‘ï¼ŒåŒ…æ‹¬æ—¶æ•ˆæ€§è®¡ç®—ã€æ¯æ—¥é™ä»·5%è§„åˆ™ã€é˜¶æ®µæ€§é™ä»·è§„åˆ™ç­‰ã€‚
            æ”¯æŒæ¨¡æ‹Ÿä¸åŒå‘å¸ƒæ—¶é—´çš„æ•°æ®ï¼ŒéªŒè¯ä»·æ ¼è®¡ç®—çš„å‡†ç¡®æ€§ã€‚
        </div>

        <!-- ç¬¬ä¸€æ­¥ï¼šä¸šåŠ¡é€»è¾‘è¯´æ˜ -->
        <div class="section">
            <h2>æ­¥éª¤1ï¼šä¸šåŠ¡é€»è¾‘è¯´æ˜</h2>
            <div class="step">
                <div class="step-title">åŠ¨æ€å®šä»·è§„åˆ™</div>
                <div class="test-scenario">
                    <div class="scenario-title">ğŸ“‹ å®šä»·è§„åˆ™è¯¦è§£</div>
                    <p><strong>1. 3å¤©å†…æ•°æ®ï¼š</strong>åŸä»·é”€å”®</p>
                    <p><strong>2. 3-7å¤©æ•°æ®ï¼š</strong>æ¯å¤©é™ä»·5%ï¼Œå…¬å¼ä¸ºï¼šåŸä»· Ã— (1 - 5% Ã— (å½“å‰å¤©æ•° - 3))</p>
                    <p><strong>3. 7-15å¤©æ•°æ®ï¼š</strong>å›ºå®šé”€å”®ä»·çš„70%</p>
                    <p><strong>4. 15-30å¤©æ•°æ®ï¼š</strong>å›ºå®šé”€å”®ä»·çš„60%</p>
                    <p><strong>5. 30å¤©ä»¥ä¸Šï¼š</strong>å›ºå®šé”€å”®ä»·çš„50%</p>
                </div>
                <div class="test-scenario">
                    <div class="scenario-title">ğŸ·ï¸ æ—¶æ•ˆæ˜¾ç¤ºå˜åŒ–</div>
                    <p><strong>3å¤©å†… â†’</strong> æ˜¾ç¤º"3å¤©å†…"</p>
                    <p><strong>4-7å¤© â†’</strong> æ˜¾ç¤º"7å¤©å†…"</p>
                    <p><strong>8-15å¤© â†’</strong> æ˜¾ç¤º"15å¤©å†…"</p>
                    <p><strong>16-30å¤© â†’</strong> æ˜¾ç¤º"30å¤©å†…"</p>
                    <p><strong>30å¤©ä»¥ä¸Š â†’</strong> æ˜¾ç¤º"è¿‘æœŸ"</p>
                </div>
            </div>
        </div>

        <!-- ç¬¬äºŒæ­¥ï¼šåˆ›å»ºæµ‹è¯•æ•°æ® -->
        <div class="section">
            <h2>æ­¥éª¤2ï¼šåˆ›å»ºæµ‹è¯•æ•°æ®</h2>
            <div class="step">
                <div class="step-title">æ ¹æ®ç”¨æˆ·ä¸šåŠ¡åœºæ™¯åˆ›å»ºæµ‹è¯•æ•°æ®</div>
                <p>æ¨¡æ‹Ÿç®¡ç†å‘˜ä»Šå¤©ä¸Šä¼ ä»¥ä¸‹3ä»½æ•°æ®ï¼š</p>
                <ul>
                    <li><strong>å°åº¦æ•°æ®ï¼š</strong>3å¤©å†…ï¼Œ10Wæ¡ï¼Œæˆæœ¬0.01ï¼Œå–ä»·0.03</li>
                    <li><strong>ç¾å›½æ•°æ®ï¼š</strong>30å¤©å†…ï¼Œ50Wæ¡ï¼Œæˆæœ¬0.01ï¼Œå–ä»·0.03</li>
                    <li><strong>å·´è¥¿æ•°æ®ï¼š</strong>30å¤©ä»¥ä¸Šï¼Œ1000Wæ¡ï¼Œæˆæœ¬0.005ï¼Œå–ä»·0.008</li>
                </ul>
                <button onclick="createTestData()">åˆ›å»ºä¸šåŠ¡åœºæ™¯æµ‹è¯•æ•°æ®</button>
                <button class="warning" onclick="clearAllData()">æ¸…ç©ºæ‰€æœ‰æ•°æ®</button>
                <div id="test-data-result"></div>
            </div>
        </div>

        <!-- ç¬¬ä¸‰æ­¥ï¼šéªŒè¯åŠ¨æ€å®šä»·è®¡ç®— -->
        <div class="section">
            <h2>æ­¥éª¤3ï¼šéªŒè¯åŠ¨æ€å®šä»·è®¡ç®—</h2>
            <div class="step">
                <div class="step-title">æµ‹è¯•ä¸åŒæ—¶é—´ç‚¹çš„ä»·æ ¼è®¡ç®—</div>
                <div class="input-group">
                    <label>é€‰æ‹©æ•°æ®ï¼š</label>
                    <select id="data-select">
                        <option value="0">å°åº¦ - 3å¤©å†…æ•°æ®</option>
                        <option value="1">ç¾å›½ - 30å¤©å†…æ•°æ®</option>
                        <option value="2">å·´è¥¿ - 30å¤©ä»¥ä¸Šæ•°æ®</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>æ¨¡æ‹Ÿå¤©æ•°ï¼š</label>
                    <input type="number" id="simulate-days" value="6" min="0" max="60" />
                    <small>ï¼ˆä»å‘å¸ƒæ—¶é—´å¼€å§‹è®¡ç®—çš„å¤©æ•°ï¼‰</small>
                </div>
                <button onclick="testPricingCalculation()">è®¡ç®—æŒ‡å®šæ—¶é—´ç‚¹çš„ä»·æ ¼</button>
                <button onclick="showPricingTrend()">æ˜¾ç¤ºä»·æ ¼è¶‹åŠ¿</button>
                <div id="pricing-result"></div>
            </div>
        </div>

        <!-- ç¬¬å››æ­¥ï¼šéªŒè¯èµ„æºä¸­å¿ƒåŒæ­¥ -->
        <div class="section">
            <h2>æ­¥éª¤4ï¼šéªŒè¯èµ„æºä¸­å¿ƒåŒæ­¥</h2>
            <div class="step">
                <div class="step-title">æ£€æŸ¥èµ„æºä¸­å¿ƒæ˜¯å¦æ­£ç¡®æ˜¾ç¤ºåŠ¨æ€ä»·æ ¼</div>
                <button onclick="checkResourceCenterData()">æ£€æŸ¥èµ„æºä¸­å¿ƒæ•°æ®</button>
                <button onclick="simulateTimePassage()">æ¨¡æ‹Ÿæ—¶é—´æµé€ï¼ˆ+1å¤©ï¼‰</button>
                <div id="resource-sync-result"></div>
            </div>
        </div>

        <!-- ç¬¬äº”æ­¥ï¼šéªŒè¯å®šä»·ç®¡ç†åŠŸèƒ½ -->
        <div class="section">
            <h2>æ­¥éª¤5ï¼šéªŒè¯å®šä»·ç®¡ç†åŠŸèƒ½</h2>
            <div class="step">
                <div class="step-title">æµ‹è¯•è‡ªå®šä¹‰å®šä»·ä¿®æ”¹å’ŒåŒæ­¥</div>
                <div class="input-group">
                    <label>é€‰æ‹©æ•°æ®ï¼š</label>
                    <select id="pricing-data-select">
                        <option value="å°åº¦">å°åº¦æ•°æ®</option>
                        <option value="ç¾å›½">ç¾å›½æ•°æ®</option>
                        <option value="å·´è¥¿">å·´è¥¿æ•°æ®</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>æ–°é”€å”®ä»·ï¼š</label>
                    <input type="number" id="new-price" value="0.025" step="0.001" min="0" />
                    <span>U/æ¡</span>
                </div>
                <button onclick="testCustomPricing()">æµ‹è¯•è‡ªå®šä¹‰å®šä»·</button>
                <button onclick="resetToDynamicPricing()">æ¢å¤åŠ¨æ€å®šä»·</button>
                <div id="pricing-management-result"></div>
            </div>
        </div>

        <!-- ç¬¬å…­æ­¥ï¼šç»¼åˆéªŒè¯ -->
        <div class="section">
            <h2>æ­¥éª¤6ï¼šç»¼åˆéªŒè¯</h2>
            <div class="step">
                <div class="step-title">éªŒè¯å®Œæ•´çš„ä¸šåŠ¡æµç¨‹</div>
                <button class="success" onclick="runFullTest()">è¿è¡Œå®Œæ•´æµ‹è¯•</button>
                <div id="full-test-result"></div>
            </div>
        </div>
    </div>

    <script>
        // åŠ¨æ€å®šä»·è®¡ç®—å‡½æ•°
        function calculateCurrentPrice(dataItem, currentTime = Date.now()) {
            const { sellPrice, costPrice, publishTime } = dataItem;
            
            if (!publishTime || !sellPrice) {
                return {
                    currentPrice: sellPrice || 0,
                    validityDisplay: 'æœªçŸ¥',
                    discountInfo: 'æ— ',
                    daysSincePublish: 0
                };
            }

            const daysSincePublish = Math.floor((currentTime - publishTime) / (1000 * 60 * 60 * 24));
            
            let currentPrice = sellPrice;
            let validityDisplay = 'æœªçŸ¥';
            let discountInfo = 'æ— æŠ˜æ‰£';

            if (daysSincePublish <= 3) {
                currentPrice = sellPrice;
                validityDisplay = '3å¤©å†…';
                discountInfo = 'åŸä»·';
            } else if (daysSincePublish <= 7) {
                const discountDays = daysSincePublish - 3;
                const discountRate = discountDays * 0.05;
                currentPrice = sellPrice * (1 - discountRate);
                validityDisplay = '7å¤©å†…';
                discountInfo = `æ¯å¤©é™ä»·5%ï¼Œå·²é™ä»·${discountDays}å¤©`;
            } else if (daysSincePublish <= 15) {
                currentPrice = sellPrice * 0.7;
                validityDisplay = '15å¤©å†…';
                discountInfo = 'å›ºå®š70%æŠ˜æ‰£';
            } else if (daysSincePublish <= 30) {
                currentPrice = sellPrice * 0.6;
                validityDisplay = '30å¤©å†…';
                discountInfo = 'å›ºå®š60%æŠ˜æ‰£';
            } else {
                currentPrice = sellPrice * 0.5;
                validityDisplay = 'è¿‘æœŸ';
                discountInfo = 'å›ºå®š50%æŠ˜æ‰£';
            }

            if (currentPrice < costPrice) {
                currentPrice = costPrice;
                discountInfo += 'ï¼ˆå·²é™åˆ¶ä¸ºæˆæœ¬ä»·ï¼‰';
            }

            return {
                currentPrice: Number(currentPrice.toFixed(4)),
                validityDisplay,
                discountInfo,
                daysSincePublish,
                originalPrice: sellPrice,
                discountPercent: ((sellPrice - currentPrice) / sellPrice * 100).toFixed(1)
            };
        }

        function getTagClass(validityDisplay) {
            if (validityDisplay === '3å¤©å†…') return 'success';
            if (validityDisplay === '7å¤©å†…') return 'warning';
            if (validityDisplay === '15å¤©å†…') return 'info';
            if (validityDisplay === '30å¤©å†…') return 'warning';
            if (validityDisplay === 'è¿‘æœŸ') return 'danger';
            return 'info';
        }

        function createTestData() {
            const now = Date.now();
            const testData = [
                {
                    id: 1,
                    country: 'å°åº¦',
                    countryCode: 'IN',
                    dataType: 'æ‰‹æœºå·ç ',
                    validity: '3',
                    source: 'å®˜æ–¹æ¸ é“',
                    availableQuantity: 100000,
                    sellPrice: 0.03,
                    costPrice: 0.01,
                    remark: '3å¤©å†…å°åº¦10Wæ¡æ•°æ®',
                    publishTime: now,
                    uploadTime: now,
                    status: 'available',
                    operators: [
                        { name: 'Airtel', count: 40000 },
                        { name: 'Jio', count: 35000 },
                        { name: 'Vi', count: 25000 }
                    ]
                },
                {
                    id: 2,
                    country: 'ç¾å›½',
                    countryCode: 'US',
                    dataType: 'æ‰‹æœºå·ç ',
                    validity: '30',
                    source: 'åˆä½œä¼™ä¼´',
                    availableQuantity: 500000,
                    sellPrice: 0.03,
                    costPrice: 0.01,
                    remark: '30å¤©å†…ç¾å›½50Wæ¡æ•°æ®',
                    publishTime: now,
                    uploadTime: now,
                    status: 'available'
                },
                {
                    id: 3,
                    country: 'å·´è¥¿',
                    countryCode: 'BR',
                    dataType: 'æ‰‹æœºå·ç ',
                    validity: '30+',
                    source: 'ç¬¬ä¸‰æ–¹é‡‡é›†',
                    availableQuantity: 10000000,
                    sellPrice: 0.008,
                    costPrice: 0.005,
                    remark: '30å¤©ä»¥ä¸Šå·´è¥¿1000Wæ¡æ•°æ®',
                    publishTime: now,
                    uploadTime: now,
                    status: 'available'
                }
            ];

            localStorage.setItem('dataList', JSON.stringify(testData));
            
            const resultDiv = document.getElementById('test-data-result');
            resultDiv.className = 'result success';
            resultDiv.innerHTML = `
                <strong>âœ… æµ‹è¯•æ•°æ®åˆ›å»ºæˆåŠŸï¼</strong><br>
                å·²åˆ›å»º ${testData.length} æ¡æµ‹è¯•æ•°æ®<br>
                å‘å¸ƒæ—¶é—´ï¼š${new Date(now).toLocaleString()}
            `;
        }

        function clearAllData() {
            localStorage.removeItem('dataList');
            document.getElementById('test-data-result').innerHTML = '<strong>âš ï¸ æ‰€æœ‰æ•°æ®å·²æ¸…ç©º</strong>';
        }

        function testPricingCalculation() {
            const dataList = JSON.parse(localStorage.getItem('dataList') || '[]');
            const selectedIndex = document.getElementById('data-select').value;
            const simulateDays = parseInt(document.getElementById('simulate-days').value);
            
            if (dataList.length === 0) {
                document.getElementById('pricing-result').innerHTML = '<strong>âŒ è¯·å…ˆåˆ›å»ºæµ‹è¯•æ•°æ®</strong>';
                return;
            }
            
            const selectedData = dataList[selectedIndex];
            const simulateTime = selectedData.publishTime + (simulateDays * 24 * 60 * 60 * 1000);
            const pricingResult = calculateCurrentPrice(selectedData, simulateTime);
            
            document.getElementById('pricing-result').innerHTML = `
                <strong>ğŸ’° å®šä»·è®¡ç®—ç»“æœ</strong><br>
                <table>
                    <tr><th>æ•°æ®ä¿¡æ¯</th><td>${selectedData.country} - ${selectedData.availableQuantity.toLocaleString()}æ¡</td></tr>
                    <tr><th>åŸå§‹ä»·æ ¼</th><td class="price">${selectedData.sellPrice} U/æ¡</td></tr>
                    <tr><th>å‘å¸ƒå¤©æ•°</th><td class="highlight">${pricingResult.daysSincePublish} å¤©</td></tr>
                    <tr><th>æ—¶æ•ˆæ˜¾ç¤º</th><td><span class="tag ${getTagClass(pricingResult.validityDisplay)}">${pricingResult.validityDisplay}</span></td></tr>
                    <tr><th>å½“å‰ä»·æ ¼</th><td class="price">${pricingResult.currentPrice} U/æ¡</td></tr>
                    <tr><th>æŠ˜æ‰£ä¿¡æ¯</th><td>${pricingResult.discountInfo}</td></tr>
                    <tr><th>é™ä»·å¹…åº¦</th><td>${pricingResult.discountPercent}%</td></tr>
                </table>
            `;
        }

        function showPricingTrend() {
            const dataList = JSON.parse(localStorage.getItem('dataList') || '[]');
            const selectedIndex = document.getElementById('data-select').value;
            
            if (dataList.length === 0) return;
            
            const selectedData = dataList[selectedIndex];
            let trendHtml = `<strong>ğŸ“ˆ ${selectedData.country}æ•°æ®ä»·æ ¼è¶‹åŠ¿</strong><br><table>
                <tr><th>å¤©æ•°</th><th>æ—¶æ•ˆæ˜¾ç¤º</th><th>é”€å”®ä»·æ ¼</th><th>æŠ˜æ‰£ä¿¡æ¯</th></tr>`;
            
            const keyDays = [0, 3, 6, 7, 10, 15, 20, 30, 45, 60];
            keyDays.forEach(day => {
                const simulateTime = selectedData.publishTime + (day * 24 * 60 * 60 * 1000);
                const result = calculateCurrentPrice(selectedData, simulateTime);
                trendHtml += `
                    <tr>
                        <td>${day}å¤©</td>
                        <td><span class="tag ${getTagClass(result.validityDisplay)}">${result.validityDisplay}</span></td>
                        <td class="price">${result.currentPrice} U/æ¡</td>
                        <td>${result.discountInfo}</td>
                    </tr>
                `;
            });
            
            trendHtml += '</table>';
            document.getElementById('pricing-result').innerHTML = trendHtml;
        }

        function checkResourceCenterData() {
            const dataList = JSON.parse(localStorage.getItem('dataList') || '[]');
            
            if (dataList.length === 0) {
                document.getElementById('resource-sync-result').innerHTML = '<strong>âŒ èµ„æºä¸­å¿ƒæ— æ•°æ®</strong>';
                return;
            }

            const updatedData = dataList.map(item => {
                const pricingResult = calculateCurrentPrice(item);
                return {
                    ...item,
                    currentSellPrice: pricingResult.currentPrice,
                    validityDisplay: pricingResult.validityDisplay,
                    discountInfo: pricingResult.discountInfo
                };
            });

            let html = '<strong>ğŸª èµ„æºä¸­å¿ƒæ•°æ®åŒæ­¥æ£€æŸ¥</strong><br><table>';
            html += '<tr><th>å›½å®¶</th><th>åŸå§‹æ—¶æ•ˆ</th><th>å½“å‰æ—¶æ•ˆ</th><th>åŸå§‹ä»·æ ¼</th><th>å½“å‰ä»·æ ¼</th><th>æŠ˜æ‰£ä¿¡æ¯</th></tr>';
            
            updatedData.forEach(item => {
                const originalValidity = { '3': '3å¤©å†…', '30': '30å¤©å†…', '30+': '30å¤©ä»¥ä¸Š' }[item.validity];
                html += `<tr>
                    <td>${item.country}</td>
                    <td><span class="tag info">${originalValidity}</span></td>
                    <td><span class="tag ${getTagClass(item.validityDisplay)}">${item.validityDisplay}</span></td>
                    <td class="price">${item.sellPrice}</td>
                    <td class="price">${item.currentSellPrice}</td>
                    <td>${item.discountInfo}</td>
                </tr>`;
            });
            
            html += '</table>';
            document.getElementById('resource-sync-result').innerHTML = html;
        }

        function simulateTimePassage() {
            const dataList = JSON.parse(localStorage.getItem('dataList') || '[]');
            
            if (dataList.length === 0) return;

            const updatedData = dataList.map(item => ({
                ...item,
                publishTime: item.publishTime - (24 * 60 * 60 * 1000)
            }));

            localStorage.setItem('dataList', JSON.stringify(updatedData));
            document.getElementById('resource-sync-result').innerHTML = '<strong>â° å·²æ¨¡æ‹Ÿæ—¶é—´æµé€+1å¤©</strong>';
        }

        function testCustomPricing() {
            const country = document.getElementById('pricing-data-select').value;
            const newPrice = parseFloat(document.getElementById('new-price').value);
            
            const dataList = JSON.parse(localStorage.getItem('dataList') || '[]');
            let updateCount = 0;
            
            const updatedData = dataList.map(item => {
                if (item.country === country) {
                    updateCount++;
                    return { ...item, sellPrice: newPrice, customPricing: true };
                }
                return item;
            });

            localStorage.setItem('dataList', JSON.stringify(updatedData));
            
            document.getElementById('pricing-management-result').innerHTML = `
                <strong>ğŸ¯ è‡ªå®šä¹‰å®šä»·æµ‹è¯•</strong><br>
                å·²å°† <strong>${country}</strong> çš„é”€å”®ä»·æ ¼ä¿®æ”¹ä¸º <span class="price">${newPrice} U/æ¡</span><br>
                å½±å“æ•°æ®æ¡æ•°ï¼š${updateCount}
            `;
        }

        function resetToDynamicPricing() {
            const country = document.getElementById('pricing-data-select').value;
            
            const dataList = JSON.parse(localStorage.getItem('dataList') || '[]');
            let updateCount = 0;
            
            const updatedData = dataList.map(item => {
                if (item.country === country && item.customPricing) {
                    updateCount++;
                    const { customPricing, ...resetItem } = item;
                    return resetItem;
                }
                return item;
            });

            localStorage.setItem('dataList', JSON.stringify(updatedData));
            
            document.getElementById('pricing-management-result').innerHTML = `
                <strong>ğŸ”„ æ¢å¤åŠ¨æ€å®šä»·</strong><br>
                å·²å°† <strong>${country}</strong> æ¢å¤ä¸ºåŠ¨æ€å®šä»·æ¨¡å¼<br>
                å½±å“æ•°æ®æ¡æ•°ï¼š${updateCount}
            `;
        }

        function runFullTest() {
            let html = '<strong>ğŸš€ å®Œæ•´æµ‹è¯•æŠ¥å‘Š</strong><br><br>';
            
            const dataList = JSON.parse(localStorage.getItem('dataList') || '[]');
            
            // æµ‹è¯•ä¸šåŠ¡åœºæ™¯æ•°æ®
            html += '<strong>Test 1: ä¸šåŠ¡åœºæ™¯éªŒè¯</strong><br>';
            if (dataList.length < 3) {
                html += 'âŒ æµ‹è¯•æ•°æ®ä¸è¶³<br><br>';
            } else {
                html += 'âœ… ä¸šåŠ¡åœºæ™¯æ•°æ®å®Œæ•´<br><br>';
            }
            
            // æµ‹è¯•ç¬¬6å¤©ä»·æ ¼è®¡ç®—
            html += '<strong>Test 2: ç¬¬6å¤©ä»·æ ¼è®¡ç®—éªŒè¯</strong><br>';
            if (dataList.length > 0) {
                const indiaData = dataList[0];
                const day6Time = indiaData.publishTime + (6 * 24 * 60 * 60 * 1000);
                const day6Result = calculateCurrentPrice(indiaData, day6Time);
                const expected = 0.03 * (1 - 0.05 * 3); // 0.03 * (100% - 15%) = 0.0255
                
                html += `è®¡ç®—ç»“æœ: ${day6Result.currentPrice} U/æ¡<br>`;
                html += `é¢„æœŸç»“æœ: ${expected.toFixed(4)} U/æ¡<br>`;
                html += `éªŒè¯: ${Math.abs(day6Result.currentPrice - expected) < 0.0001 ? 'âœ… é€šè¿‡' : 'âŒ å¤±è´¥'}<br><br>`;
            }
            
            // æµ‹è¯•æ—¶æ•ˆæ˜¾ç¤ºå˜åŒ–
            html += '<strong>Test 3: æ—¶æ•ˆæ˜¾ç¤ºå˜åŒ–éªŒè¯</strong><br>';
            if (dataList.length > 0) {
                const testData = dataList[0];
                const testDays = [2, 5, 10, 20, 40];
                testDays.forEach(day => {
                    const testTime = testData.publishTime + (day * 24 * 60 * 60 * 1000);
                    const result = calculateCurrentPrice(testData, testTime);
                    html += `ç¬¬${day}å¤©: ${result.validityDisplay}<br>`;
                });
            }
            
            html += '<br><strong>æµ‹è¯•å®Œæˆï¼</strong>';
            document.getElementById('full-test-result').innerHTML = html;
        }
    </script>
</body>
</html>