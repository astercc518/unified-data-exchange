# æ“ä½œæ—¥å¿—è‡ªåŠ¨åˆ·æ–°åŠŸèƒ½

## é—®é¢˜æè¿°

**ç”¨æˆ·åé¦ˆ**: æ–°å¢KL06ä»£ç†,åœ¨æ“ä½œæ—¥å¿—æŸ¥çœ‹æ²¡æœ‰ç«‹å³æ˜¾ç¤ºè®°å½•,éœ€è¦æ‰‹åŠ¨åˆ·æ–°æ‰æ˜¾ç¤º

**é—®é¢˜åŸå› **: 
- æ“ä½œæ—¥å¿—é¡µé¢æ˜¯é™æ€çš„,ä¸ä¼šè‡ªåŠ¨è·å–æœ€æ–°æ•°æ®
- åˆ›å»ºä»£ç†ç­‰æ“ä½œå,éœ€è¦æ‰‹åŠ¨åˆ·æ–°æµè§ˆå™¨æˆ–é‡æ–°è¿›å…¥é¡µé¢æ‰èƒ½çœ‹åˆ°æ–°çš„æ—¥å¿—è®°å½•
- ç”¨æˆ·ä½“éªŒä¸ä½³

---

## è§£å†³æ–¹æ¡ˆ

### âœ… æ·»åŠ è‡ªåŠ¨åˆ·æ–°åŠŸèƒ½

ä¸ºæ“ä½œæ—¥å¿—é¡µé¢å¢åŠ ä»¥ä¸‹åŠŸèƒ½:

1. **å®šæ—¶è‡ªåŠ¨åˆ·æ–°**: æ¯30ç§’è‡ªåŠ¨åˆ·æ–°ä¸€æ¬¡æ—¥å¿—åˆ—è¡¨
2. **æ‰‹åŠ¨åˆ·æ–°æŒ‰é’®**: ç‚¹å‡»ç«‹å³åˆ·æ–°æœ€æ–°æ•°æ®
3. **è‡ªåŠ¨åˆ·æ–°å¼€å…³**: ç”¨æˆ·å¯ä»¥éšæ—¶å¼€å¯/å…³é—­è‡ªåŠ¨åˆ·æ–°
4. **æ™ºèƒ½åˆ·æ–°**: è‡ªåŠ¨åˆ·æ–°æ—¶ä¸æ˜¾ç¤ºloading,é¿å…é¡µé¢é—ªçƒ

---

## åŠŸèƒ½ç‰¹æ€§

### 1. å®šæ—¶è‡ªåŠ¨åˆ·æ–° â°

- **åˆ·æ–°é—´éš”**: 30ç§’
- **é»˜è®¤çŠ¶æ€**: å¼€å¯
- **åˆ·æ–°æ–¹å¼**: é™é»˜åˆ·æ–°(ä¸æ˜¾ç¤ºloadingçŠ¶æ€)
- **è‡ªåŠ¨æ¸…ç†**: é¡µé¢é”€æ¯æ—¶è‡ªåŠ¨åœæ­¢å®šæ—¶å™¨,é¿å…å†…å­˜æ³„æ¼

### 2. æ‰‹åŠ¨åˆ·æ–°æŒ‰é’® ğŸ”„

- **ä½ç½®**: ç­›é€‰æ¡ä»¶åŒºåŸŸ,"é‡ç½®"æŒ‰é’®æ—è¾¹
- **å›¾æ ‡**: el-icon-refresh
- **åŠŸèƒ½**: ç‚¹å‡»ç«‹å³åˆ·æ–°æ—¥å¿—åˆ—è¡¨
- **åé¦ˆ**: æ˜¾ç¤º"æ­£åœ¨åˆ·æ–°..."æç¤º

### 3. è‡ªåŠ¨åˆ·æ–°å¼€å…³ ğŸšï¸

- **æ§ä»¶**: Element UI Switchå¼€å…³
- **ä½ç½®**: ç­›é€‰æ¡ä»¶åŒºåŸŸæœ€å³ä¾§
- **æ ‡ç­¾**: "è‡ªåŠ¨åˆ·æ–°"
- **çŠ¶æ€æç¤º**:
  - å¼€å¯æ—¶: "å·²å¼€å¯è‡ªåŠ¨åˆ·æ–°(æ¯30ç§’)"
  - å…³é—­æ—¶: "å·²å…³é—­è‡ªåŠ¨åˆ·æ–°"

---

## ç•Œé¢æ•ˆæœ

### ä¿®æ”¹å‰

```
[æ—¥å¿—ç±»å‹â–¼] [æ“ä½œäºº____] [å¼€å§‹æ—¥æœŸ è‡³ ç»“æŸæ—¥æœŸ] [æœç´¢] [é‡ç½®] [æ¸…ç©ºå†å²]
```

### ä¿®æ”¹å

```
[æ—¥å¿—ç±»å‹â–¼] [æ“ä½œäºº____] [å¼€å§‹æ—¥æœŸ è‡³ ç»“æŸæ—¥æœŸ] [æœç´¢] [é‡ç½®] [ğŸ”„åˆ·æ–°] [æ¸…ç©ºå†å²] [è‡ªåŠ¨åˆ·æ–° âšªï¸]
```

---

## ä½¿ç”¨è¯´æ˜

### åœºæ™¯1: æŸ¥çœ‹æœ€æ–°æ“ä½œæ—¥å¿—(é»˜è®¤)

1. è¿›å…¥"ç³»ç»Ÿç®¡ç†" > "æ“ä½œæ—¥å¿—"é¡µé¢
2. è‡ªåŠ¨åˆ·æ–°é»˜è®¤å¼€å¯,æ¯30ç§’è‡ªåŠ¨æ›´æ–°
3. åˆ›å»ºä»£ç†/å®¢æˆ·ç­‰æ“ä½œå,æœ€å¤šç­‰å¾…30ç§’å°±èƒ½çœ‹åˆ°æ–°è®°å½•
4. **æ— éœ€æ‰‹åŠ¨åˆ·æ–°é¡µé¢** âœ…

### åœºæ™¯2: éœ€è¦ç«‹å³æŸ¥çœ‹æœ€æ–°æ—¥å¿—

1. è¿›è¡ŒæŸä¸ªæ“ä½œ(å¦‚åˆ›å»ºä»£ç†KL06)
2. ç«‹å³åˆ‡æ¢åˆ°æ“ä½œæ—¥å¿—é¡µé¢
3. ç‚¹å‡»"åˆ·æ–°"æŒ‰é’® ğŸ”„
4. ç«‹å³æ˜¾ç¤ºæœ€æ–°çš„æ—¥å¿—è®°å½•

### åœºæ™¯3: åˆ†æå†å²æ—¥å¿—(å…³é—­è‡ªåŠ¨åˆ·æ–°)

1. è¿›å…¥æ“ä½œæ—¥å¿—é¡µé¢
2. è®¾ç½®ç­›é€‰æ¡ä»¶(æ—¥æœŸèŒƒå›´ã€æ“ä½œäººç­‰)
3. å…³é—­"è‡ªåŠ¨åˆ·æ–°"å¼€å…³
4. ä¸“æ³¨åˆ†æå½“å‰æ•°æ®,ä¸ä¼šè¢«è‡ªåŠ¨åˆ·æ–°æ‰“æ–­

---

## æŠ€æœ¯å®ç°

### æ ¸å¿ƒä»£ç 

**æ–‡ä»¶**: `/src/views/system/logs.vue`

#### 1. æ•°æ®å±æ€§

```javascript
data() {
  return {
    // ... å…¶ä»–å±æ€§
    autoRefresh: true,        // é»˜è®¤å¼€å¯è‡ªåŠ¨åˆ·æ–°
    refreshTimer: null,       // å®šæ—¶å™¨
    refreshInterval: 30000    // åˆ·æ–°é—´éš”30ç§’
  }
}
```

#### 2. ç”Ÿå‘½å‘¨æœŸé’©å­

```javascript
created() {
  this.getList()
  // å¯åŠ¨è‡ªåŠ¨åˆ·æ–°
  if (this.autoRefresh) {
    this.startAutoRefresh()
  }
},
beforeDestroy() {
  // ç»„ä»¶é”€æ¯æ—¶æ¸…é™¤å®šæ—¶å™¨,é¿å…å†…å­˜æ³„æ¼
  this.stopAutoRefresh()
}
```

#### 3. è‡ªåŠ¨åˆ·æ–°æ–¹æ³•

```javascript
// å¼€å¯è‡ªåŠ¨åˆ·æ–°
startAutoRefresh() {
  this.stopAutoRefresh() // å…ˆæ¸…é™¤å·²æœ‰çš„å®šæ—¶å™¨
  this.refreshTimer = setInterval(() => {
    // é™é»˜åˆ·æ–°,ä¸æ˜¾ç¤ºloading
    const originalLoading = this.listLoading
    this.listLoading = false
    this.getList().finally(() => {
      this.listLoading = originalLoading
    })
  }, this.refreshInterval)
  console.log('âœ… è‡ªåŠ¨åˆ·æ–°å·²å¯åŠ¨(æ¯30ç§’)')
}

// åœæ­¢è‡ªåŠ¨åˆ·æ–°
stopAutoRefresh() {
  if (this.refreshTimer) {
    clearInterval(this.refreshTimer)
    this.refreshTimer = null
    console.log('â¸ è‡ªåŠ¨åˆ·æ–°å·²åœæ­¢')
  }
}

// åˆ‡æ¢è‡ªåŠ¨åˆ·æ–°
toggleAutoRefresh(value) {
  if (value) {
    this.startAutoRefresh()
    this.$message.success('å·²å¼€å¯è‡ªåŠ¨åˆ·æ–°(æ¯30ç§’)')
  } else {
    this.stopAutoRefresh()
    this.$message.info('å·²å…³é—­è‡ªåŠ¨åˆ·æ–°')
  }
}

// æ‰‹åŠ¨åˆ·æ–°
handleRefresh() {
  this.$message.success('æ­£åœ¨åˆ·æ–°...')
  this.getList()
}
```

#### 4. æ¨¡æ¿å˜åŒ–

```html
<!-- æ·»åŠ åˆ·æ–°æŒ‰é’® -->
<el-button class="filter-item" icon="el-icon-refresh" @click="handleRefresh">
  åˆ·æ–°
</el-button>

<!-- æ·»åŠ è‡ªåŠ¨åˆ·æ–°å¼€å…³ -->
<el-switch
  v-model="autoRefresh"
  active-text="è‡ªåŠ¨åˆ·æ–°"
  inactive-text=""
  class="filter-item"
  style="margin-left: 10px;"
  @change="toggleAutoRefresh"
/>
```

---

## æ€§èƒ½ä¼˜åŒ–

### 1. é™é»˜åˆ·æ–°

è‡ªåŠ¨åˆ·æ–°æ—¶ä¸æ˜¾ç¤ºloadingçŠ¶æ€,é¿å…é¡µé¢é—ªçƒ:

```javascript
// ä¿å­˜åŸå§‹loadingçŠ¶æ€
const originalLoading = this.listLoading
this.listLoading = false
this.getList().finally(() => {
  this.listLoading = originalLoading
})
```

### 2. å®šæ—¶å™¨æ¸…ç†

ç¡®ä¿ç»„ä»¶é”€æ¯æ—¶æ¸…é™¤å®šæ—¶å™¨,é¿å…å†…å­˜æ³„æ¼:

```javascript
beforeDestroy() {
  this.stopAutoRefresh()
}
```

### 3. é‡å¤å®šæ—¶å™¨é˜²æŠ¤

å¯åŠ¨æ–°å®šæ—¶å™¨å‰å…ˆæ¸…é™¤æ—§å®šæ—¶å™¨:

```javascript
startAutoRefresh() {
  this.stopAutoRefresh() // å…ˆæ¸…é™¤å·²æœ‰çš„å®šæ—¶å™¨
  this.refreshTimer = setInterval(...)
}
```

---

## ç”¨æˆ·ä½“éªŒæå‡

### ä¿®å¤å‰ âŒ

1. åˆ›å»ºä»£ç†KL06
2. åˆ‡æ¢åˆ°æ“ä½œæ—¥å¿—é¡µé¢
3. çœ‹ä¸åˆ°æ–°è®°å½•
4. **å¿…é¡»æ‰‹åŠ¨åˆ·æ–°æµè§ˆå™¨(F5)** ğŸ˜¤
5. çœ‹åˆ°æ–°è®°å½•

### ä¿®å¤å âœ…

#### æ–¹å¼1: ç­‰å¾…è‡ªåŠ¨åˆ·æ–°(æœ€å¤š30ç§’)

1. åˆ›å»ºä»£ç†KL06
2. åˆ‡æ¢åˆ°æ“ä½œæ—¥å¿—é¡µé¢
3. ç­‰å¾…æœ€å¤š30ç§’
4. **è‡ªåŠ¨æ˜¾ç¤ºæ–°è®°å½•** ğŸ˜Š

#### æ–¹å¼2: ç«‹å³æ‰‹åŠ¨åˆ·æ–°

1. åˆ›å»ºä»£ç†KL06
2. åˆ‡æ¢åˆ°æ“ä½œæ—¥å¿—é¡µé¢
3. **ç‚¹å‡»"åˆ·æ–°"æŒ‰é’®** ğŸ”„
4. ç«‹å³æ˜¾ç¤ºæ–°è®°å½•

---

## é…ç½®è¯´æ˜

### ä¿®æ”¹åˆ·æ–°é—´éš”

å¦‚æœéœ€è¦ä¿®æ”¹è‡ªåŠ¨åˆ·æ–°é—´éš”,ç¼–è¾‘ `/src/views/system/logs.vue`:

```javascript
data() {
  return {
    // ...
    refreshInterval: 30000  // å•ä½:æ¯«ç§’
    // 15ç§’: 15000
    // 30ç§’: 30000 (é»˜è®¤)
    // 60ç§’: 60000
  }
}
```

### é»˜è®¤å…³é—­è‡ªåŠ¨åˆ·æ–°

å¦‚æœå¸Œæœ›é»˜è®¤å…³é—­è‡ªåŠ¨åˆ·æ–°:

```javascript
data() {
  return {
    // ...
    autoRefresh: false  // æ”¹ä¸ºfalse
  }
}
```

---

## æµ‹è¯•éªŒè¯

### æµ‹è¯•æ­¥éª¤

1. **ç™»å½•ç®¡ç†å‘˜è´¦å·**
   - è®¿é—®: http://103.246.246.11:9528
   - è´¦å·: admin
   - å¯†ç : 58ganji@123

2. **è¿›å…¥æ“ä½œæ—¥å¿—é¡µé¢**
   - ç‚¹å‡»"ç³»ç»Ÿç®¡ç†" > "æ“ä½œæ—¥å¿—"
   - ç¡®è®¤"è‡ªåŠ¨åˆ·æ–°"å¼€å…³ä¸ºå¼€å¯çŠ¶æ€ âœ…

3. **åˆ›å»ºæµ‹è¯•ä»£ç†**
   - ä¸è¦ç¦»å¼€æ“ä½œæ—¥å¿—é¡µé¢
   - æ–°å¼€ä¸€ä¸ªæµè§ˆå™¨æ ‡ç­¾é¡µ
   - è¿›å…¥"ä»£ç†ç®¡ç†" > "æ–°å¢ä»£ç†"
   - å¡«å†™ä¿¡æ¯åˆ›å»ºä»£ç†KL07

4. **éªŒè¯è‡ªåŠ¨åˆ·æ–°**
   - å›åˆ°æ“ä½œæ—¥å¿—é¡µé¢
   - ç­‰å¾…æœ€å¤š30ç§’
   - è§‚å¯Ÿæ—¥å¿—åˆ—è¡¨æ˜¯å¦è‡ªåŠ¨æ›´æ–°
   - âœ… åº”è¯¥çœ‹åˆ°"åˆ›å»ºä»£ç†: KL07"çš„è®°å½•

5. **æµ‹è¯•æ‰‹åŠ¨åˆ·æ–°**
   - å†æ¬¡åˆ›å»ºä»£ç†KL08
   - ç«‹å³ç‚¹å‡»"åˆ·æ–°"æŒ‰é’® ğŸ”„
   - âœ… åº”è¯¥ç«‹å³çœ‹åˆ°"åˆ›å»ºä»£ç†: KL08"çš„è®°å½•

6. **æµ‹è¯•å…³é—­è‡ªåŠ¨åˆ·æ–°**
   - å…³é—­"è‡ªåŠ¨åˆ·æ–°"å¼€å…³
   - åˆ›å»ºä»£ç†KL09
   - ç­‰å¾…30ç§’
   - âŒ æ—¥å¿—åˆ—è¡¨ä¸ä¼šè‡ªåŠ¨æ›´æ–°
   - ç‚¹å‡»"åˆ·æ–°"æŒ‰é’®
   - âœ… æ˜¾ç¤ºæœ€æ–°è®°å½•

---

## å…¼å®¹æ€§è¯´æ˜

### Element UIç‰ˆæœ¬

- éœ€è¦ Element UI â‰¥ 2.0
- `el-switch`ç»„ä»¶æ”¯æŒ
- `el-button`ç»„ä»¶çš„iconå±æ€§æ”¯æŒ

### æµè§ˆå™¨å…¼å®¹æ€§

- âœ… Chrome/Edge (æ¨è)
- âœ… Firefox
- âœ… Safari
- âœ… IE11+ (éœ€è¦polyfill)

---

## æ³¨æ„äº‹é¡¹

### 1. ç½‘ç»œè¯·æ±‚é¢‘ç‡

- è‡ªåŠ¨åˆ·æ–°ä¼šæ¯30ç§’å‘é€ä¸€æ¬¡APIè¯·æ±‚
- å¦‚æœæœ‰å¤§é‡ç”¨æˆ·åŒæ—¶ä½¿ç”¨,æ³¨æ„æœåŠ¡å™¨è´Ÿè½½
- å»ºè®®ä¸è¦å°†åˆ·æ–°é—´éš”è®¾ç½®å¾—è¿‡çŸ­(â‰¥15ç§’)

### 2. æ•°æ®ä¸€è‡´æ€§

- è‡ªåŠ¨åˆ·æ–°ä¸ä¼šå½±å“å½“å‰çš„ç­›é€‰æ¡ä»¶
- é¡µç å’Œæ¯é¡µæ¡æ•°ä¿æŒä¸å˜
- åªåˆ·æ–°å½“å‰é¡µçš„æ•°æ®

### 3. ç”¨æˆ·ä¹ æƒ¯

- éƒ¨åˆ†ç”¨æˆ·å¯èƒ½ä¹ æƒ¯æ‰‹åŠ¨åˆ·æ–°
- æä¾›å¼€å…³è®©ç”¨æˆ·è‡ªç”±é€‰æ‹©
- å¼€å…³çŠ¶æ€ä¸ä¼šæŒä¹…åŒ–(åˆ·æ–°é¡µé¢åæ¢å¤é»˜è®¤)

---

## æ‰©å±•åŠŸèƒ½(å¯é€‰)

### 1. æŒä¹…åŒ–å¼€å…³çŠ¶æ€

ä½¿ç”¨localStorageä¿å­˜ç”¨æˆ·çš„å¼€å…³åå¥½:

```javascript
// ä»localStorageè¯»å–
created() {
  const saved = localStorage.getItem('logAutoRefresh')
  if (saved !== null) {
    this.autoRefresh = saved === 'true'
  }
  // ...
}

// ä¿å­˜åˆ°localStorage
toggleAutoRefresh(value) {
  localStorage.setItem('logAutoRefresh', value)
  // ...
}
```

### 2. æ–°æ—¥å¿—æç¤º

æ£€æµ‹åˆ°æ–°æ—¥å¿—æ—¶æ˜¾ç¤ºé€šçŸ¥:

```javascript
getList() {
  // ...
  const newCount = response.total - this.total
  if (newCount > 0 && !this.listLoading) {
    this.$notify({
      title: 'æ–°æ—¥å¿—',
      message: `å‘ç° ${newCount} æ¡æ–°çš„æ“ä½œæ—¥å¿—`,
      type: 'info',
      duration: 3000
    })
  }
  // ...
}
```

### 3. æ™ºèƒ½åˆ·æ–°é—´éš”

æ ¹æ®é¡µé¢æ´»è·ƒåº¦è°ƒæ•´åˆ·æ–°é¢‘ç‡:

```javascript
// é¡µé¢å¯è§æ—¶30ç§’åˆ·æ–°,ä¸å¯è§æ—¶åœæ­¢åˆ·æ–°
document.addEventListener('visibilitychange', () => {
  if (document.hidden) {
    this.stopAutoRefresh()
  } else if (this.autoRefresh) {
    this.startAutoRefresh()
  }
})
```

---

## ç›¸å…³æ–‡æ¡£

- [æ“ä½œæ—¥å¿—åŠŸèƒ½æŒ‡å—](./OPERATION-LOG-GUIDE.md)
- [åˆ›å»ºä»£ç†æ—¥å¿—ä¿®å¤æŠ¥å‘Š](./CREATE-AGENT-LOG-ISSUE-FIX.md)
- [æ“ä½œæ—¥å¿—éªŒè¯æŒ‡å—](./CREATE-AGENT-LOG-VERIFICATION.md)

---

**åŠŸèƒ½å¼€å‘å®Œæˆ**: 2025-10-21  
**æµ‹è¯•çŠ¶æ€**: âœ… å¾…å‰ç«¯éƒ¨ç½²åéªŒè¯  
**å»ºè®®åˆ·æ–°é—´éš”**: 30ç§’(å¯é…ç½®)  
**é»˜è®¤çŠ¶æ€**: å¼€å¯è‡ªåŠ¨åˆ·æ–°
