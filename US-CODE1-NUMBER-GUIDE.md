# 前缀为1的美国号码处理指南

## 📌 数据格式说明

### 标准格式
```
1 + 区号(3位) + 号码(7位) = 11位

示例：
12025551234  (华盛顿特区 202)
13105552345  (洛杉矶 310)
14155553456  (旧金山 415)
12125554567  (纽约 212)
```

### 格式特点
- ✅ **总长度**：11位数字
- ✅ **国码前缀**：1（美国/加拿大/多米尼加共用）
- ✅ **区号**：3位（如 202、310、415、212 等）
- ✅ **本地号码**：7位

---

## 🔄 系统处理流程

### 步骤详解

**原始号码：** `12025551234`

#### 1️⃣ 数据清理
```
输入: 12025551234
处理: 去除所有非数字字符
输出: 12025551234
```

#### 2️⃣ 国码识别
```
长度检查: 11位 ✓
前缀检查: 开头是"1" ✓
标准长度: 1位国码 + 10位号码 = 11位 ✓
结论: 这是带国码的美国号码
```

#### 3️⃣ 去除国码
```
原始: 12025551234
处理: 去掉开头的"1"
结果: 2025551234 (10位)
```

#### 4️⃣ 提取区号
```
10位号码: 2025551234
区号提取: 前3位 = 202
本地号码: 后7位 = 5551234
```

#### 5️⃣ 运营商匹配
```
检查步骤:
1. 检查区号 202 是否在 Verizon 的配置列表中
2. 检查区号 202 是否在 AT&T 的配置列表中
3. 检查区号 202 是否在 T-Mobile 的配置列表中

匹配结果:
- 如果区号在某个运营商的列表中 → 归入该运营商
- 如果区号不在任何列表中 → 计入未匹配数量
```

---

## ⚠️ 重要说明

### 模拟分配机制

**请注意：这是基于区号的模拟分组，不代表真实运营商归属！**

#### 为什么是"模拟"？
1. **共享区号池**
   - 美国所有运营商共享相同的区号资源
   - 同一个区号（如 202）下的号码可能属于不同运营商
   - 无法通过区号准确识别真实运营商

2. **实际情况**
   ```
   区号 202 的号码可能属于：
   ✓ Verizon
   ✓ AT&T
   ✓ T-Mobile
   ✓ Sprint
   ✓ 其他运营商
   
   系统只是按配置将所有 202 区号归入某一个运营商组
   ```

3. **系统行为**
   - 根据预设的区号配置进行分组
   - 仅用于数据分类和管理
   - 会在界面上明确显示警告说明

---

## 🧪 测试数据

### 已准备的测试文件
**位置：** `/tmp/us_data_with_code1.txt`
**内容：** 29条美国号码

### 区号分布
```
202 (华盛顿特区): 5条
310 (洛杉矶):     5条
415 (旧金山):     5条
212 (纽约):       5条
646 (纽约):       3条
718 (纽约):       3条
323 (洛杉矶):     3条
```

### 查看测试数据
```bash
cat /tmp/us_data_with_code1.txt
```

---

## 📝 使用指南

### 方式一：按运营商提取（理解限制）

#### 操作步骤
1. 进入【数据处理】模块
2. 上传文件（如 `/tmp/us_data_with_code1.txt`）
3. 点击【按运营商提取】
4. 选择文件和国家（美国 +1）
5. 等待分析完成

#### 预期结果
✅ **成功识别**
- 系统能正确识别11位格式的美国号码
- 自动去除国码"1"
- 提取区号进行匹配
- 显示运营商分布统计

⚠️ **警告提示**
- 显示："美国运营商共享相同的区号池"
- 说明："此分配仅按区号进行模拟分组"
- 强调："不代表真实运营商归属"

✓ **可用功能**
- 查看各运营商的号码数量
- 选择运营商进行提取
- 设置提取条数限制
- 下载提取结果（保留原始11位格式）

#### 适用场景
- 需要按区号分类数据
- 了解并接受模拟分配的限制
- 用于数据管理和分组

---

### 方式二：按条数提取（⭐ 推荐）

#### 操作步骤
1. 进入【数据处理】模块
2. 上传文件
3. 点击【按条数提取】
4. 设置起始位置和提取数量
5. 执行提取

#### 优势
- ✅ 简单直接
- ✅ 不受运营商识别限制
- ✅ 准确可靠
- ✅ 保留原始格式

#### 适用场景
- 只需要提取固定数量的号码
- 不关心运营商分类
- 追求简单和准确

---

## ✅ 验证清单

### 上传后检查
- [ ] 文件成功上传
- [ ] 显示正确的行数
- [ ] 无异常数据被过滤

### 预览检查
- [ ] 点击【预览】按钮
- [ ] 看到前20条数据
- [ ] 数据格式为11位
- [ ] 检测到国码 +1
- [ ] 置信度显示正常

### 运营商分析
- [ ] 选择国家：美国 (+1)
- [ ] 分析成功完成
- [ ] 显示运营商列表
- [ ] 显示数量和占比
- [ ] 看到警告提示

### 提取功能
- [ ] 可以选择运营商
- [ ] 可以设置提取条数
- [ ] 提取成功
- [ ] 下载的文件格式正确（11位）
- [ ] 数据内容准确

---

## 🔍 常见问题

### Q1: 为什么我的号码显示"未匹配"？
**A:** 可能的原因：
1. 区号不在当前配置的范围内
2. 号码格式不标准（不是11位）
3. 数据包含非数字字符

**解决方法：**
- 使用【预览】功能检查数据格式
- 确认号码是11位且以1开头
- 检查区号是否为有效的美国区号

---

### Q2: 为什么所有运营商的数量都一样？
**A:** 这不是正常情况。可能的原因：
1. 所有运营商配置了相同的区号列表
2. 文件中的号码区号分布非常均匀

**正常情况：**
- 不同运营商应该有不同的匹配数量
- 取决于文件中区号的实际分布

---

### Q3: 提取后的文件格式是什么？
**A:** 
- 保留原始的11位格式
- 包含国码"1"
- 每行一个号码
- 示例：12025551234

---

### Q4: 可以同时提取多个运营商吗？
**A:** 
- ✅ 可以！
- 选择多个运营商
- 为每个运营商设置不同的提取条数
- 系统会生成多个文件供下载

---

## 📊 区号参考

### 常见美国区号
```
东部时区：
202 - 华盛顿特区
212, 646, 917, 347 - 纽约
305, 786, 954 - 佛罗里达
617, 857 - 波士顿

中部时区：
312, 773, 872 - 芝加哥
214, 469, 972 - 达拉斯
713, 281, 832 - 休斯顿

西部时区：
310, 323, 424, 213 - 洛杉矶
415, 628 - 旧金山
206, 253 - 西雅图
```

---

## 🚀 快速开始

### 1分钟快速测试

```bash
# 1. 运行测试脚本
/home/vue-element-admin/test-us-with-code1.sh

# 2. 查看测试数据
cat /tmp/us_data_with_code1.txt

# 3. 访问系统
http://localhost:9528

# 4. 上传测试文件并开始测试
```

---

## 📞 技术支持

### 相关文档
- [完整修复总结](./US-OPERATOR-FIX-SUMMARY.md)
- [更新说明](./US-OPERATOR-EXTRACTION-UPDATE.md)
- [快速参考](./US-OPERATOR-QUICK-REF.md)

### 测试脚本
- 基础测试：`test-us-operator-extraction.sh`
- 前缀1测试：`test-us-with-code1.sh`

---

**文档版本：** v1.0  
**最后更新：** 2025-10-17  
**适用范围：** 前缀为1的11位美国号码
